function t(r,n,u){return t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}()?Reflect.construct.bind():function(t,r,n){var u=[null];u.push.apply(u,r);var i=new(Function.bind.apply(t,u));return n&&e(i,n.prototype),i},t.apply(null,arguments)}function e(t,r){return e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},e(t,r)}var r=function(t){return""===t},n=function(t){if(t===undefined)return!1;if(null===t)return!0;for(var e in t)return!1;return!0},u=function(t,e){return t&&"string"==typeof e};Array.prototype.removeEmpty||(Array.prototype.removeEmpty=function(){for(var t=[],e=0,r=this.length;e<r;e++){var u=this[e];null!=u&&""!==u&&(u instanceof Array&&0===u.length||u instanceof Object&&n(u)||t.push(u))}return t}),function(){if("object"!=typeof JSON){JSON={};var t,e,r,n,u=/^[\],:{}\s]*$/,i=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,c=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,o=/(?:^|:|,)(?:\s*\[)+/g,a=/[\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,f=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+s(this.getUTCMonth()+1)+"-"+s(this.getUTCDate())+"T"+s(this.getUTCHours())+":"+s(this.getUTCMinutes())+":"+s(this.getUTCSeconds())+"Z":"Invalid Date"}),"function"!=typeof JSON.stringify&&(r={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(r,u,i){var c;if(t="",e="","number"==typeof i)for(c=0;c<i;c+=1)e+=" ";else"string"==typeof i&&(e=i);if(n=u,u&&"function"!=typeof u&&("object"!=typeof u||"number"!=typeof u.length))throw new Error("JSON.stringify");return p("",{"":r})}),"function"!=typeof JSON.parse&&(JSON.parse=function(t,e){var r;if(t=String(t),f.lastIndex=0,f.test(t)&&(t=t.replace(f,(function(t){return"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)}))),u.test(t.replace(i,"@").replace(c,"]").replace(o,"")))return r=Function("return ("+t+")")(),"function"==typeof e?function n(t,r){var u,i,c=t[r];if(c&&"object"==typeof c)for(u in c)Object.prototype.hasOwnProperty.call(c,u)&&((i=n(c,u))!==undefined?c[u]=i:delete c[u]);return e.call(t,r,c)}({"":r},""):r;throw new Error("JSON.parse")})}function s(t){return t<10?"0"+t:t}function l(t){return a.lastIndex=0,a.test(t)?'"'+t.replace(a,(function(t){var e=r[t];return"string"==typeof e?e:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)}))+'"':'"'+t+'"'}function p(r,u){var i,c,o,a,f,s=t,x=u[r];switch(x&&"object"==typeof x&&"function"==typeof x.toJSON&&(x=x.toJSON(r)),"function"==typeof n&&(x=n.call(u,r,x)),typeof x){case"string":return l(x);case"number":return isFinite(x)?String(x):"null";case"boolean":return String(x);case"object":if(!x)return"null";if(t+=e,f=[],"[object Array]"===Object.prototype.toString.apply(x)){for(a=x.length,i=0;i<a;i+=1)f[i]=p(String(i),x)||"null";return o=0===f.length?"[]":t?"[\n"+t+f.join(",\n"+t)+"\n"+s+"]":"["+f.join(",")+"]",t=s,o}if(n&&"object"==typeof n)for(a=n.length,i=0;i<a;i+=1)"string"==typeof n[i]&&(o=p(c=String(n[i]),x))&&f.push(l(c)+(t?": ":":")+o);else for(c in x)Object.prototype.hasOwnProperty.call(x,c)&&(o=p(c,x))&&f.push(l(c)+(t?": ":":")+o);return o=0===f.length?"{}":t?"{\n"+t+f.join(",\n"+t)+"\n"+s+"}":"{"+f.join(",")+"}",t=s,o}return"null"}}();var i=function(){for(var e,r=arguments.length,n=new Array(r),u=0;u<r;u++)n[u]=arguments[u];if(1===n.length)e=n[0];else{var i=n[0],c=n[1],o=n.slice(2);e=t(Date,[i,c-1].concat(o)).getTime()}var a=(.001*e+11644473600)/1e-7/Math.pow(2,32),f=Math.floor(a);return{high:f,low:(a-f)*Math.pow(2,32)}},c=function(t){for(var e,r=[],n=null!=(e=t.split(","))?e:[0],u=0;u<n.length;u++){var c=n[u];r.push(Number(c))}var o=i.apply(void 0,r);return o.high+"."+o.low},o=function(t,e,r){var n,u,i,o,a=undefined;~(t=(t=t.replace(/\\/g,"\\\\")).replace(e,r)).indexOf(',"comment":')&&(t=t.replace(/,"comment":\s?"(.+)"/,(function(t,e){return a='T:"'+e.replace(/""/g,"`")+'"',""})));var f=JSON.parse(t),s=f.att!=undefined&&""!==f.att?f.att:"0",l=f.ext!=undefined?"X:"+f.ext:undefined,p=f.hl?"H:"+f.hl:undefined,x=f.mark?"M:"+f.mark:undefined,P=f.oid&&f.ovalue?"O"+f.oid+':"'+f.ovalue+'"':undefined,d=[],v=d[0],m=d[1],g=d[2];return f.date?(m=v=c(f.date),g=v):(v=f.create?c(f.create):"0.0",m=f.access?c(f.access):"0.0",g=f.write?c(f.write):"0.0"),['"'+(null!=(n=f.name)?n:"")+'"','"'+(null!=(u=f.sname)?u:"")+'"',"A:H"+s,"C:"+v,"L:"+m,"W:"+g,"S:"+(null!=(i=f.size)?i:"0.0"),"R:"+(null!=(o=f.reparse)?o:"0.0"),l,p,x,P,a].removeEmpty().join(",")},a="jp",f="\r\n",s="K_ppmTemp",l=function(){return"cache\\"+PPx.Extract("%0").slice(3).replace(/\\/g,"@")},p=PPx.CreateObject("Scripting.FileSystemObject"),x={TypeToCode:{crlf:"\r\n",cr:"\r",lf:"\n"},CodeToType:{"\r\n":"crlf","\r":"cr","\n":"lf"},Ppx:{lf:"%%bl",cr:"%%br",crlf:"%%bn",unix:"%%bl",mac:"%%br",dos:"%%bn","\n":"%%bl","\r":"%%br","\r\n":"%%bn"},Ascii:{lf:"10",cr:"13",crlf:"-1",unix:"10",mac:"13",dos:"-1","\n":"10","\r":"13","\r\n":"-1"}},P=function(t,e){try{var r;return[!1,null!=(r=e())?r:""]}catch(n){return[!0,""]}finally{t.Close()}},d=function(t){var e=t.path,n=t.enc,u=function(t){var e=t.path,r=t.enc,n=void 0===r?"utf8":r;if(!p.FileExists(e))return[!0,e+" not found"];var u=p.GetFile(e);if(0===u.Size)return[!0,e+" has no data"];var i=!1,c="";if("utf8"===n){var o=PPx.CreateObject("ADODB.Stream"),a=P(o,(function(){return o.Open(),o.Charset="UTF-8",o.LoadFromFile(e),o.ReadText(-1)}));i=a[0],c=a[1]}else{var f="utf16le"===n?-1:0,s=u.OpenAsTextStream(1,f),l=P(s,(function(){return s.ReadAll()}));i=l[0],c=l[1]}return i?[!0,"Unable to read "+e]:[!1,c]}({path:e,enc:void 0===n?"utf8":n}),i=u[0],c=u[1];if(i)return[!0,c];var o=function(t){var e="\n",r=t.indexOf("\r");return~r&&(e="\r\n"==t.substring(r,r+2)?"\r\n":"\r"),e}(c.slice(0,1e3)),a=c.split(o);return r(a[a.length-1])&&a.pop(),[!1,{lines:a,nl:o}]},v=function(t){var e=t.path,r=t.data,n=t.enc,u=void 0===n?"utf8":n,i=t.append,c=void 0!==i&&i,o=t.overwrite,a=void 0!==o&&o,s=t.linefeed,l=void 0===s?f:s;if(!a&&!c&&p.FileExists(e))return[!0,e+" already exists"];var d,v=p.GetParentFolderName(e);if(p.FolderExists(v)||PPx.Execute("*makedir "+v),"utf8"===u){if("ClearScriptV8"===PPx.ScriptEngineName){var m=r.join(l),g=c?"AppendAllText":"WriteAllText";return[!1,NETAPI.System.IO.File[g](e,m)]}var E=a||c?2:1,h=PPx.CreateObject("ADODB.Stream");d=P(h,(function(){h.Open(),h.Charset="UTF-8",h.LineSeparator=Number(x.Ascii[l]),c?(h.LoadFromFile(e),h.Position=h.Size,h.SetEOS):h.Position=0,h.WriteText(r.join(l),1),h.SaveToFile(e,E)}))[0]}else{var b=c?8:a?2:1,y="utf16le"===u?-1:0,O=p.GetFile(e).OpenAsTextStream(b,y);d=P(O,(function(){O.Write(r.join(l)+l)}))[0]}return d?[!0,"Could not write to "+e]:[!1,""]},m=/^([ABCEFHKMPSVX][BCEVTt]?_|_[CPSUWo]|Mes)/,g=function(t,e){if(0===e.indexOf("@")){if(e=PPx.Extract(e).substring(1),!p.FileExists(e))return 2}else if(!t.test(e))return 13;return 0},E=function(t,e,n){return void 0===e&&(e=""),e=r(e)?"":"/"+e,0===PPx.Execute('%"ppm'+e+'" %OC %'+t+'"'+n+'"')},h=function(){return"undefined"!=typeof ppm_test_run&&ppm_test_run<=2},b=function(t){return"."!==t},y={lang:a},O=function(t){var e=PPx.Extract("%*getcust(S_ppm#global:"+t+")");return y[t]=e,e},S="K_ppmTemp",C={echo:function(t,e,r){var n=r?"("+String(r)+")":"";return E("I",""+t,""+e+n)},question:function(t,e){return E("Q",""+t,e)},choice:function(t,e,r,n,u,i,c){void 0===n&&(n="ynC");var o="Mes0411",a=o+":IMYE",f=o+":IMNO",s=o+":IMTC",l="."===t,p=l?'%K"@LOADCUST"':'%%K"@LOADCUST"',x=[],P=x[0],d=x[1],v=x[2],m="",g="",E="",h=!1;u&&(P=PPx.Extract("%*getcust("+a+")"),m="*setcust "+a+"="+u+"%:",h=!0),i&&(d=PPx.Extract("%*getcust("+f+")"),g="*setcust "+f+"="+i+"%:",h=!0),c&&(v=PPx.Extract("%*getcust("+s+")"),E="*setcust "+s+"="+c+"%:",h=!0),h&&(PPx.Execute(""+m+g+E),C.execute(t,p));var b=l?"":t,y=PPx.Extract("%OCP %*extract("+b+'"%%*choice(-text""'+r+'"" -title:""'+e+'"" -type:'+n+')")');return h&&(P&&PPx.Execute("*setcust "+a+"="+P),d&&PPx.Execute("*setcust "+f+"="+d),v&&PPx.Execute("*setcust "+s+"= "+v),C.execute(t,p)),{0:"cancel",1:"yes",2:"no"}[y]},execute:function(t,e,n){return void 0===n&&(n=!1),r(e)?1:h()?2===ppm_test_run&&PPx.Execute("*execute B,*linemessage %%bx1b[2F[Execute] "+t+",%("+e+"%)"):"tray"===t?PPx.Execute("*pptray -c "+e):b(t)?n?Number(PPx.Extract("%*extract("+t+',"'+e+'%%:0")')):PPx.Execute("*execute "+t+","+e):PPx.Execute(e)},execSync:function(t,e){if(r(e))return 1;if(h())return 2===ppm_test_run&&PPx.Execute("*execute B,*linemessage %%bx1b[2F[Execute] "+t+",%("+e+"%)");if(1===t.length)t="b"+t;else if(0!==t.toUpperCase().indexOf("B"))return 6;return r(PPx.Extract("%N"+t))?6:Number(PPx.Extract("%*extract("+t.toUpperCase()+',"'+e+'%%:%%*exitcode")'))},extract:function(t,e){if(r(e))return[13,""];var n=b(t)?PPx.Extract("%*extract("+t+',"'+e+'")'):PPx.Extract(e);return[Number(PPx.Extract()),n]},lang:function(){var t=y.lang;if(!r(t))return t;var e=PPx.Extract("%*getcust(S_ppm#global:lang)");return t="en"===e||"jp"===e?e:a,y.lang=t,t},global:function(t){var e,n,u=y[t];if(u)return u;if(/^ppm[ahrcl]?/.test(t)){if(u=PPx.Extract("%sgu'"+t+"'"),r(u)){var i=t.replace("ppm","");switch(i){case"":u=null!=(e=y.ppm)?e:PPx.Extract("%*getcust(S_ppm#global:ppm)");break;case"home":u=null!=(n=y.home)?n:PPx.Extract("%*getcust(S_ppm#global:home)");break;case"lib":var c;u=(null!=(c=y.ppm)?c:O("ppm"))+"\\dist\\lib";break;default:var o,a=null!=(o=y.home)?o:O("home");"cache"===i&&(u=a+"\\"+l())}}}else u=PPx.Extract("%*getcust(S_ppm#global:"+t+")");return y[t]=u,u},user:function(t){return PPx.Extract('%*extract("%%*getcust(S_ppm#user:'+t+')")')},setuser:function(t,e){return r(e)?1:PPx.Execute("*setcust S_ppm#user:"+t+"="+e)},getpath:function(t,e,n){void 0===n&&(n="");var u=g(/^[CXTDHLKBNPRVSU]+$/,t);if(0!==u)return[u,""];if(r(e))return[1,""];var i=r(n)?"":',"'+n+'"',c=PPx.Extract("%*name("+t+',"'+e+'"'+i+")");return[u=Number(PPx.Extract()),c]},getcust:function(t){if(r(t))return[1,""];var e=g(m,t);return 0!==e?[e,""]:[e,PPx.Extract("%*getcust("+t+")")]},setcust:function(t,e){if(void 0===e&&(e=!1),r(t))return 1;var n=g(m,t);if(0!==n)return n;var u=e?"%OC ":"";return PPx.Execute(u+"*setcust "+t)},deletecust:function(t,e,n){var u="boolean"==typeof e,i=/^\s*"?([^"\s]+)"?\s*?$/,c=t.replace(i,"$1"),o=String(e),a=g(m,c);if(0!==a)return a;var f=null==e||u||r(o)?'"'+c+'"':c+","+("string"==typeof e?'"'+e.replace(i,"$1")+'"':""+e);return PPx.Execute("*deletecust "+f),n&&PPx.Execute('%K"loadcust"'),0},setkey:function(t,e,n){if(void 0===n&&(n=!1),r(t))throw new Error("SubId is empty");var u=n?"%OC ":"";return PPx.Execute(u+"*setcust "+s+":"+t+","+e),s},deletekeys:function(){PPx.Execute('*deletecust "'+s+'"')},linecust:function(t){var e=t.label,n=t.id,u=t.sep,i=void 0===u?"=":u,c=t.value,o=void 0===c?"":c,a=t.esc,f=void 0!==a&&a,s=t.once,l=void 0!==s&&s?"*linecust "+e+","+n+",%%:":"";!r(o)&&f&&(o="%("+o+"%)"),PPx.Execute("*linecust "+e+","+n+i+l+o)},getvalue:function(t,e,n){if(r(n))return[1,""];var u=b(t)?PPx.Extract("%*extract("+t+',"%%s'+e+"'"+n+"'\")"):PPx.Extract("%s"+e+"'"+n+"'");return[r(u)?13:0,u]},setvalue:function(t,e,n,u){return r(n)?1:b(t)?PPx.Execute("*execute "+t+",*string "+e+","+n+"="+u):PPx.Execute("*string "+e+","+n+"="+u)},getinput:function(t){var e,r=t.message,n=void 0===r?"":r,u=t.title,i=void 0===u?"":u,c=t.mode,o=void 0===c?"g":c,a=t.select,f=void 0===a?"a":a,s=t.multi,l=void 0!==s&&s,p=t.leavecancel,x=void 0!==p&&p,P=t.forpath,d=void 0!==P&&P,v=t.fordijit,m=void 0!==v&&v,E=t.autoselect,h=void 0!==E&&E,b=t.k,y=void 0===b?"":b,O=l?" -multi":"",C=x?" -leavecancel":"",N=d?" -forpath":"",j=m?" -fordijit":"";h&&(e=y,PPx.Execute("%OC *setcust "+S+':ENTER,*if -1==%%*sendmessage(%%N-L,392,0,0)%%:%%K"@DOWN"%bn%bt%%K"@ENTER"'),PPx.Execute("%OC *setcust "+S+':\\ENTER,*if -1==%%*sendmessage(%%N-L,392,0,0)%%:%%K"@DOWN"%bn%bt%%K"@ENTER"'),y="*mapkey use,"+S+"%%:"+e);var T=""!==y?" -k %%OP- "+y:"",F=g(/^[gnmshdcfuxeREOUX][gnmshdcfuxeSUX,]*$/,o);if(0!==F)return[F,""];var _=PPx.Extract('%OCP %*input("'+n+'" -title:"'+i+'" -mode:'+o+" -select:"+f+O+C+N+j+T+")");return F=Number(PPx.Extract()),h&&PPx.Execute('*deletecust "'+S+'"'),[F,_]},linemessage:function(t,e,r,n){var u,i="B"===PPx.Extract("%n").substring(0,1);if("object"==typeof e){var c=n?"%%bn":" ";u=e.join(c)}else u=e;t="."===t?"":t,u=r&&!i?'!"'+u:u,PPx.Execute("%OC *execute "+t+",*linemessage "+u)},report:function(t){var e="string"==typeof t?t:t.join(f);0===PPx.Extract("%n").indexOf("B")?PPx.linemessage(e):PPx.report(e)},close:function(t){PPx.Execute("*closeppx "+t)},jobstart:function(t){return C.execute(t,"*job start"),function(){return C.execute(t,"*job end")}},getVersion:function(t){var e=d({path:t+="\\package.json"}),r=e[0],n=e[1];if(!u(r,n))for(var i=/^\s*"version":\s*"([0-9\.]+)"\s*,/,c=2,o=n.lines.length;c<o;c++)if(~n.lines[c].indexOf('"version":'))return n.lines[c].replace(i,"$1")}},N=function(){var t,e,r=PPx.ScriptName;return~r.indexOf("\\")?(t=r.replace(/^.*\\/,""),e=PPx.Extract("%*name(DKN,"+r+")")):(t=r,e=PPx.Extract("%FDN")),{scriptName:t,parentDir:e.replace(/\\$/,"")}}(),j=N.scriptName,T={en:{notExists:"Comment file does not exist"},jp:{notExists:"コメントファイルがありません"}}[function(){var t=PPx.Extract("%*getcust(S_ppm#global:lang)");return"en"===t||"jp"===t?t:a}()],F=function(t){void 0===t&&(t=PPx.Arguments);for(var e=["M wF20 S1 C13 s1","utf8"],r=0,n=t.length;r<n;r++)e[r]=t.Item(r);return/^(utf8|utf16le)$/.test(e[1])||(e[1]="utf8"),{fmt:e[0],enc:e[1]}};!function(){var t=PPx.Extract("%FD\\00_INDEX.TXT");p.FileExists(t)||(C.echo(j,T.notExists),PPx.Quit(1));var e=d({path:t,enc:"utf16le"}),r=e[0],n=e[1];u(r,n)&&(C.echo(j,n),PPx.Quit(1));var i,c=F(),a=(i=PPx.Extract('%*extract(C,"%%*temp()")'),{dir:i,file:i+"_ppmtemp",lf:i+"_temp.xlf",stdout:i+"_stdout",stderr:i+"_stderr",ppmDir:function(){var t=PPx.Extract("%'temp'%\\ppm");return PPx.Execute("*makedir "+t),t}}).lf,f=[';cmd=*viewstyle -temp format "'+c.fmt+'"',";ppm=comment"],s=PPx.Extract("%FD"),l="⏎\t"+s+"\t2010",x=function(t){var e=t.charset,r=void 0===e?"utf-8":e,n=t.basepath,u=t.dirtype,i=void 0===u?"0":u,c=t.opts,o=[";ListFile",";charset="+r];if(""!==n&&o.push(";Base="+n+"|"+i),c&&c.length>0)for(var a=0;a<c.length;a++){var f=c[a];o.push(f)}return o}({basepath:s,dirtype:"4",opts:f}),P=function(t){for(var e=t.lines,r=t.rgx,n=t.rep,u=[],i=0;i<e.length;i++){var c=e[i];u.push(o(c,r,n))}return u}({lines:[l].concat(n.lines),rgx:/^([^\t]*)\t([^\t]+)(\t(\d+))?$/,rep:'{"name":"$2","att":"$4","comment":"$1"}'}),m=v({path:a,data:[].concat(x,P),enc:c.enc,overwrite:!0});r=m[0],n=m[1],r&&(C.echo(j,n),PPx.Quit(1)),PPx.Execute("*jumppath "+a)}();
