var e="jp",t="\r\n",r="K_ppmTemp",n=function(){return"cache\\"+PPx.Extract("%0").slice(3).replace(/\\/g,"@")},u=PPx.CreateObject("Scripting.FileSystemObject"),c=function(e){return""===e},i=function(e,t){try{var r;return[!1,null!=(r=t())?r:""]}catch(n){return[!0,""]}finally{e.Close()}},a=function(e){var t=e.path,r=e.enc,n=function(e){var t=e.path,r=e.enc,n=void 0===r?"utf8":r;if(!u.FileExists(t))return[!0,t+" not found"];var c=u.GetFile(t);if(0===c.Size)return[!0,t+" has no data"];var a=!1,s="";if("utf8"===n){var x=PPx.CreateObject("ADODB.Stream"),o=i(x,(function(){return x.Open(),x.Charset="UTF-8",x.LoadFromFile(t),x.ReadText(-1)}));a=o[0],s=o[1]}else{var l="utf16le"===n?-1:0,P=c.OpenAsTextStream(1,l),f=i(P,(function(){return P.ReadAll()}));a=f[0],s=f[1]}return a?[!0,"Unable to read "+t]:[!1,s]}({path:t,enc:void 0===r?"utf8":r}),a=n[0],s=n[1];if(a)return[!0,s];var x=function(e){var t="\n",r=e.indexOf("\r");return~r&&(t="\r\n"==e.substring(r,r+2)?"\r\n":"\r"),t}(s.slice(0,1e3)),o=s.split(x);return c(o[o.length-1])&&o.pop(),[!1,{lines:o,nl:x}]},s=/^([ABCEFHKMPSVX][BCEVTt]?_|_[CPSUWo]|Mes)/,x=function(e,t){if(0===t.indexOf("@")){if(t=PPx.Extract(t).substring(1),!u.FileExists(t))return 2}else if(!e.test(t))return 13;return 0},o=function(e,t,r){return void 0===t&&(t=""),t=c(t)?"":"/"+t,0===PPx.Execute('%"ppm'+t+'" %OC %'+e+'"'+r+'"')},l=function(){return"undefined"!=typeof ppm_test_run&&ppm_test_run<=2},P=function(e){return"."!==e},f={lang:e},p=function(e){var t=PPx.Extract("%*getcust(S_ppm#global:"+e+")");return f[e]=t,t},v="K_ppmTemp",E={echo:function(e,t,r){var n=r?"("+String(r)+")":"";return o("I",""+e,""+t+n)},question:function(e,t){return o("Q",""+e,t)},choice:function(e,t,r,n,u,c,i){void 0===n&&(n="ynC");var a="Mes0411",s=a+":IMYE",x=a+":IMNO",o=a+":IMTC",l="."===e,P=l?'%K"@LOADCUST"':'%%K"@LOADCUST"',f=[],p=f[0],v=f[1],m=f[2],d="",g="",b="",h=!1;u&&(p=PPx.Extract("%*getcust("+s+")"),d="*setcust "+s+"="+u+"%:",h=!0),c&&(v=PPx.Extract("%*getcust("+x+")"),g="*setcust "+x+"="+c+"%:",h=!0),i&&(m=PPx.Extract("%*getcust("+o+")"),b="*setcust "+o+"="+i+"%:",h=!0),h&&(PPx.Execute(""+d+g+b),E.execute(e,P));var O=l?"":e,C=PPx.Extract("%OCP %*extract("+O+'"%%*choice(-text""'+r+'"" -title:""'+t+'"" -type:'+n+')")');return h&&(p&&PPx.Execute("*setcust "+s+"="+p),v&&PPx.Execute("*setcust "+x+"="+v),m&&PPx.Execute("*setcust "+o+"= "+m),E.execute(e,P)),{0:"cancel",1:"yes",2:"no"}[C]},execute:function(e,t){return c(t)?1:l()?2===ppm_test_run&&PPx.Execute("*execute B,*linemessage %%bx1b[2F[Execute] "+e+",%("+t+"%)"):"tray"===e?PPx.Execute("*pptray -c "+t):P(e)?PPx.Execute("*execute "+e+","+t):PPx.Execute(t)},execSync:function(e,t){if(c(t))return 1;if(l())return 2===ppm_test_run&&PPx.Execute("*execute B,*linemessage %%bx1b[2F[Execute] "+e+",%("+t+"%)");if(1===e.length)e="b"+e;else if(0!==e.toUpperCase().indexOf("B"))return 6;return Number(PPx.Extract("%*extract("+e.toUpperCase()+',"'+t+'%%:%%*exitcode")'))},extract:function(e,t){if(c(t))return[13,""];var r=P(e)?PPx.Extract("%*extract("+e+',"'+t+'")'):PPx.Extract(t);return[Number(PPx.Extract()),r]},lang:function(){var t=f.lang;if(!c(t))return t;var r=PPx.Extract("%*getcust(S_ppm#global:lang)");return t="en"===r||"jp"===r?r:e,f.lang=t,t},global:function(e){var t,r,u=f[e];if(u)return u;if(/^ppm[ahrcl]?/.test(e)){if(u=PPx.Extract("%sgu'"+e+"'"),c(u)){var i=e.replace("ppm","");switch(i){case"":u=null!=(t=f.ppm)?t:PPx.Extract("%*getcust(S_ppm#global:ppm)");break;case"home":u=null!=(r=f.home)?r:PPx.Extract("%*getcust(S_ppm#global:home)");break;case"lib":var a;u=(null!=(a=f.ppm)?a:p("ppm"))+"\\dist\\lib";break;default:var s,x=null!=(s=f.home)?s:p("home");"cache"===i&&(u=x+"\\"+n())}}}else u=PPx.Extract("%*getcust(S_ppm#global:"+e+")");return f[e]=u,u},user:function(e){return PPx.Extract('%*extract("%%*getcust(S_ppm#user:'+e+')")')},setuser:function(e,t){return c(t)?1:PPx.Execute("*setcust S_ppm#user:"+e+"="+t)},getpath:function(e,t,r){void 0===r&&(r="");var n=x(/^[CXTDHLKBNPRVSU]+$/,e);if(0!==n)return[n,""];if(c(t))return[1,""];var u=c(r)?"":',"'+r+'"',i=PPx.Extract("%*name("+e+',"'+t+'"'+u+")");return[n=Number(PPx.Extract()),i]},getcust:function(e){if(c(e))return[1,""];var t=x(s,e);return 0!==t?[t,""]:[t,PPx.Extract("%*getcust("+e+")")]},setcust:function(e,t){if(void 0===t&&(t=!1),c(e))return 1;var r=x(s,e);if(0!==r)return r;var n=t?"%OC ":"";return PPx.Execute(n+"*setcust "+e)},deletecust:function(e,t,r){var n="boolean"==typeof t,u=/^\s*"?([^"\s]+)"?\s*?$/,i=e.replace(u,"$1"),a=String(t),o=x(s,i);if(0!==o)return o;var l=null==t||n||c(a)?'"'+i+'"':i+","+("string"==typeof t?'"'+t.replace(u,"$1")+'"':""+t);return PPx.Execute("*deletecust "+l),r&&PPx.Execute('%K"loadcust"'),0},setkey:function(e,t,n){if(void 0===n&&(n=!1),c(e))throw new Error("SubId is empty");var u=n?"%OC ":"";return PPx.Execute(u+"*setcust "+r+":"+e+","+t),r},deletekeys:function(){PPx.Execute('*deletecust "'+r+'"')},linecust:function(e){var t=e.label,r=e.id,n=e.sep,u=void 0===n?"=":n,i=e.value,a=void 0===i?"":i,s=e.esc,x=void 0!==s&&s,o=e.once,l=void 0!==o&&o?"*linecust "+t+","+r+",%%:":"";!c(a)&&x&&(a="%("+a+"%)"),PPx.Execute("*linecust "+t+","+r+u+l+a)},getvalue:function(e,t,r){if(c(r))return[1,""];var n=P(e)?PPx.Extract("%*extract("+e+',"%%s'+t+"'"+r+"'\")"):PPx.Extract("%s"+t+"'"+r+"'");return[c(n)?13:0,n]},setvalue:function(e,t,r,n){return c(r)?1:P(e)?PPx.Execute("*execute "+e+",*string "+t+","+r+"="+n):PPx.Execute("*string "+t+","+r+"="+n)},getinput:function(e){var t,r=e.message,n=void 0===r?"":r,u=e.title,c=void 0===u?"":u,i=e.mode,a=void 0===i?"g":i,s=e.select,o=void 0===s?"a":s,l=e.multi,P=void 0!==l&&l,f=e.leavecancel,p=void 0!==f&&f,E=e.forpath,m=void 0!==E&&E,d=e.fordijit,g=void 0!==d&&d,b=e.autoselect,h=void 0!==b&&b,O=e.k,C=void 0===O?"":O,S=P?" -multi":"",y=p?" -leavecancel":"",_=m?" -forpath":"",j=g?" -fordijit":"";h&&(t=C,PPx.Execute("%OC *setcust "+v+':ENTER,*if -1==%%*sendmessage(%%N-L,392,0,0)%%:%%K"@DOWN"%bn%bt%%K"@ENTER"'),PPx.Execute("%OC *setcust "+v+':\\ENTER,*if -1==%%*sendmessage(%%N-L,392,0,0)%%:%%K"@DOWN"%bn%bt%%K"@ENTER"'),C="*mapkey use,"+v+"%%:"+t);var N=""!==C?" -k %%OP- "+C:"",T=x(/^[gnmshdcfuxeREOUX][gnmshdcfuxeSUX,]*$/,a);if(0!==T)return[T,""];var R=PPx.Extract('%OCP %*input("'+n+'" -title:"'+c+'" -mode:'+a+" -select:"+o+S+y+_+j+N+")");return T=Number(PPx.Extract()),h&&PPx.Execute('*deletecust "'+v+'"'),[T,R]},linemessage:function(e,t,r,n){var u,c="B"===PPx.Extract("%n").substring(0,1);if("object"==typeof t){var i=n?"%%bn":" ";u=t.join(i)}else u=t;e="."===e?"":e,u=r&&!c?'!"'+u:u,PPx.Execute("%OC *execute "+e+",*linemessage "+u)},report:function(e){var r="string"==typeof e?e:e.join(t);0===PPx.Extract("%n").indexOf("B")?PPx.linemessage(r):PPx.report(r)},close:function(e){PPx.Execute("*closeppx "+e)},jobstart:function(e){return E.execute(e,"*job start"),function(){return E.execute(e,"*job end")}},getVersion:function(e){var t=a({path:e+="\\package.json"}),r=t[0],n=t[1];if(!function(e,t){return e&&"string"==typeof t}(r,n))for(var u=/^\s*"version":\s*"([0-9\.]+)"\s*,/,c=2,i=n.lines.length;c<i;c++)if(~n.lines[c].indexOf('"version":'))return n.lines[c].replace(u,"$1")}},m={en:{title:"Comment search"},jp:{title:"コメント検索"}}[function(){var t=PPx.Extract("%*getcust(S_ppm#global:lang)");return"en"===t||"jp"===t?t:e}()],d=function(e){void 0===e&&(e=PPx.Arguments);for(var t=["0",m.title,"e",""],r=0,n=e.length;r<n;r++)t[r]=e.Item(r);return{useRgx:"0"!==t[0],title:t[1],mode:t[2],complist:t[3]}},g=function(e,t){if(!t)return function(t){return!~t.toLowerCase().indexOf(e.toLowerCase())};var r=function(e){var t=e;return~e.indexOf("-")?t=~e.indexOf(".")?e.replace(/^([^\.]+)\.([^-]+)-/,"(?=.*$1)(?!.*$2)"):e.replace(/^([^-]+)-/,"(?!$1)"):e.indexOf(".")&&(t=e.replace(/([^\.]+)\.(.+)/,"(?=.*$1)(?=.*$2)")),new RegExp(t,"i")}(e);return function(e){return!r.test(e)}};!function(){var e=d(),t=e.title+" ([AND]: a.b, [MINUS]: a.b-, [OR]: a|b)",r=['-detail:"user1"%%:*comletelist match:6 -module:off'];u.FileExists(e.complist)&&r.push('-file:"'+e.complist+'"');var n=E.getinput({title:t,mode:e.mode,leavecancel:!0,k:r.join(" ")}),c=n[0],i=n[1];0!==c&&PPx.Quit(-1);for(var a=g(i,e.useRgx),s=PPx.EntryDisplayCount;s--;){var x=PPx.Entry.Item(s);a(x.Comment)&&x.Hide()}}();
